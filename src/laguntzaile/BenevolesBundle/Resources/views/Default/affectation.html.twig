{% extends "::vueMere.html.twig" %}

{% block contenuCentral %}

        <div class="panel panel-default">
            <h4 class="centrer">{{(personneEtEvenement[0].idEvenement.nom)}}</h4>
        </div>
        <br />

<h4>{{(personneEtEvenement[0].idPersonne.prenom)}} {{(personneEtEvenement[0].idPersonne.nom)}},</h4>
        <br />
        {% if tabAffectationsDejaTraitees|length != 0 %}
            {% if tabAffectationsDejaTraitees|length != 0 %}
                <p>Voici l'affectation que vous avez déjà traité : </p>
            {% else %}
                <p>Voici la liste des affectations que vous avez déjà traité : </p>
            {% endif %}
                <br />
<table class="table">
                <thead>
                  <tr>
                    <th>Poste</th>
                    <th>Tour</th>
                    <th>Choix</th>
                  </tr>
                </thead>
                <tbody>
            {% for affectation in tabAffectationsDejaTraitees %}

                     <tr>
                            <td>{{affectation.idTour.idPoste.nom}}</td>
                         
                         {% if affectation.idTour.debut|date("d") == affectation.idTour.fin|date("d") %}
                         
                            <td>Le {{affectation.idTour.debut|date("d/m/Y")}}, de {{affectation.idTour.debut|date("H:i")}} à {{affectation.idTour.fin|date("H:i")}} </td>
                         
                         {% else %}
                         
                            <td>De {{affectation.idTour.debut|date("d/m/Y H:i") }} à {{affectation.idTour.fin|date("d/m/Y H:i")}}</td>
                         
                         {% endif %}
                            <td>
                                {% if affectation.statut == "acceptee" %}
                                    <p>Acceptée</p>
                                {% else %}
                                    <p>Refusée</p>
                                {% endif %}
                            </td>
                        </tr>
                    {% endfor %}
               </tbody>
            </table>
        <br />
        {% endif %}
        
        {% if tabAffectations|length == 0 %}
            <p class="centrer"> <em>Aucune propositions d'affectation pour l'instant.</em></p>
        {% else %}
            {% if tabAffectations|length == 1 %}
                <p> Voici l'affectation qui vous est proposée :</p>
            {% elseif tabAffectations|length > 1 %}
                <p> Voici la liste des affectations qui vous sont proposées :</p>
            {% endif %}
     
<form method="post" {{form_enctype(formulaireAffectation)}}  novalidate="novalidate" >
            <table class="table">
                
                <col id="tailleColonneTableau1" width="50%">
                <col id="tailleColonneTableau2" width="50%">
                <col id="tailleColonneTableau3" width="0%">
                
                <thead>
                  <tr>
                    <th>Poste</th>
                    <th>Tour</th>
                    <th id="titreColonnePoste" hidden=true>Choix</th>
                  </tr>

                    
                </thead>
                <tbody>
                   {% set nb=0 %}
                   {% for affectation in tabAffectations %}

                     <tr>
                            <td class="nomDuPoste">{{affectation.idTour.idPoste.nom}}</td>
                         
                         {% if affectation.idTour.debut|date("d") == affectation.idTour.fin|date("d") %}
                         
                            <td>Le {{affectation.idTour.debut|date("d/m/Y")}}, de {{affectation.idTour.debut|date("H:i")}} à {{affectation.idTour.fin|date("H:i")}} </td>
                         
                         {% else %}
                         
                            <td>De {{affectation.idTour.debut|date("d/m/Y H:i") }} à {{affectation.idTour.fin|date("d/m/Y H:i")}}</td>
                         
                         {% endif %}
                            <td id="coupleDeBoutons{{nb}}" hidden=true>
                                {{form_widget(formulaireAffectation["radio" ~ affectation.id])}}
                                <br />
                                <span id="span_form_radio{{affectation.id}}" hidden=true>
                                    {{form_widget(formulaireAffectation["commentaire" ~ affectation.id])}}
                                </span>
                            </td>
                        </tr>
                    {% set nb=nb+1 %}
                    {% endfor %}
               </tbody>
            </table>

    
    <div name="bouton" class="centrer"> 
            {{form_widget(formulaireAffectation["maCaseACocher"])}}{{form_label(formulaireAffectation["maCaseACocher"])}}</p>
            <input class="btn btn-primary" type="submit" value="Envoyer !">
    </div>
    </form>


<script type="text/javascript">
function test(ele)
{
    idElementCourant = ele.id; // ça c'est bon
    concatenation = idElementCourant+"_1";
    elementRadio = document.getElementById(concatenation);
    spanAModifier = document.getElementById("span_"+idElementCourant);
    

    spanAModifier.setAttribute('hidden', 'true'); // Pour faire réapparaître
    
    if(elementRadio.checked == true)
    {
        spanAModifier.removeAttribute('hidden'); // Pour supprimer le hidden       
    }
    else
    {
        spanAModifier.setAttribute('hidden', 'true'); // Pour faire réapparaître
    }
}
    
function cacher(ele)
{
    var caseACocher=document.getElementById(ele.id);
    var titreColonne = document.getElementById("titreColonnePoste");

    
    if (caseACocher.checked)
    {
        titreColonne.setAttribute('hidden','true');
        document.getElementById("tailleColonneTableau1").setAttribute('width','50%');
        document.getElementById("tailleColonneTableau2").setAttribute('width','50%');
        for (i=0; i<{{nb}}; i++)
        {
           document.getElementById("coupleDeBoutons"+i).setAttribute('hidden','true');
         document.getElementById("coupleDeBoutons"+i).children[0].children[0].setAttribute('checked','true');
        }
        
    }
    else
    {
        titreColonne.removeAttribute('hidden');
        document.getElementById("tailleColonneTableau1").setAttribute('width','30%');
        document.getElementById("tailleColonneTableau2").setAttribute('width','40%');
        document.getElementById("tailleColonneTableau3").setAttribute('width','30%');
        for (i=0; i<{{nb}}; i++)
        {
           document.getElementById("coupleDeBoutons"+i).removeAttribute('hidden');
            document.getElementById("coupleDeBoutons"+i).children[0].children[0].setAttribute('checked','true');
        }
    }
}
    
</script>
        {% endif %}
{% endblock %}